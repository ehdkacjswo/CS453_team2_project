# DeepGA
Search-based test case generation, using genetic algorithm enhanced by deep neural networks  
Team project for CS453 Automated Software Testing, Spring 2020, KAIST

## About
DeepGA is a search-based test case generation program which automatically generates test cases of python program, aiming for high branch coverage.  
Searching strategy is based on enhanced genetic algorithm (GA), intriguing properties of deep neural networks (DNN).  
We improved vanila GA by training and inferencing DNN simultaneously, using following approaches:
- **Approximation of fitness function for GA.** 
We approximated the fitness function calculation with DNN inference. This can reduce number of execution of program required for searching, thus can be benefitial when the target program is expensive to execute.
- **guided mutation using gradient descent.**
When generating next population, we substracted the current gradient of DNN, which guarantees that the population is improved if the DNN is perfectly approximating the fitness function.
## Structure
DeepGA project consists of two parts.
- `deepga_tool` : a main tool module that gives generated test case (target function arguments for testing) that achieves coverage for each leaf branches.
- `evaluation` : a module for evaluating the performance of main tool. It includes a submodule, `gen_src`, a context-aware random python source generator that generates sources with no undefined reference error and satisfies source acceptable range of our main tool.
```
├── deepga_tool
└── evaluation
    └── gen_src
```
## Usage
Following commands should be done at the root directory of the project.  
First, install dependencies.
```
pip install -r requirements.txt
```
\
To use the main tool, run
```
python -m deepga_tool evaluation/manual_src/sample5.py
````
Where `evaluation/manual_src/sample5.py` can be replaced with the path to the target program you want.  
The default setting is to use both DNN fitness approximation and DNN guided mutation. You are allowed to select other options using `--method`.  
Refer to `python -m deepga_tool -h` for more available options.  
\
Possible output from `deepga_tool` is as follows, where `1T`, `1F`, ... indicates target branches. Note that **our program targets only the leaf branches**, thus the result doesn't contain non-leaf branches.
```
1F : [2, 707, 108]
2T : [641, 1, 328]
3F : [-140, 545, 670]
4T : [4, -202, 192]
4F : [-1, 251, -441]
2F : [346, -1, -1]
{'test_me': FuncResult(num_exec=337, coverage=100.0, elasped_time=0.10883402824401855)}
```  
\
To use the evaluation module, run
```
python -m evaluation
```
The default setting is to run `deepga_tool` to every sources under `evaluation/manual_src/`.  
If you want to use sources generated by module `gen_src`, use `-g $COUNT`, where `$COUNT` is the number of sources you want to generate and run `deepga_tool` on it.
